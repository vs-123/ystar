# Y-star -- vs-123

import numpy as np
import matplotlib.pyplot as plt
import scipy.stats as stats

sequence_str = """1  22  18  10  16  1  8  7  17  19  8  5  19  25  23  8  15  25  4  19  6  1  8  21  11  3  17  22  3  16  23  11  11  3  25  22  3  4  6  16  4  23  19  3  3  1  16  14  10  7  6  23  20  19  5  16  13  21  22  21  9  15  13  15  24  25  25  13  9  2  8  24  5  13  6  12  2  7  1  23  16  14  9  1  25  16  22  4  13  11  16  13  13  5  11  12  10  14  15  10  15  20  18  5  13  3  17  3  14  14  22  4  7  5  4  16  3  3  3  3  14  10  13  7  4  21  6  17  13  9  22  10  18  18  9  22  12  16  13  4  5  14  5  16  2  20  11  1  14  7  21  24  19  16  24  4  17  21  12  12  12  8  17  23  3  8  11  25  12  18  1  24  16  8  17  18  23  6  1  14  6  20  7  24  12  17  9  18  7  10  21  21  4  14  25  24  15  16  19  7  13  5  19  11  2  9  9  10  15  24  13  21  1  1  13  20  15  18  2  19  21  17  22  20  10  2  20  14  7  10  20  16  24  25  2  16  14  16  25  8  2  12  16  20  8  6  25  3  9  19  7  12  20  8  19  7  18  10  2  23  24  6  20  15  21  17  1  24  8  14  14  10  22  3  3  18  11  20  15  15  12  1  9  14  19  4  16  8  5  10  1  1  25  16  16  21  21  10  19  25  2  22  8  1  15  12  2  22  4  20  5  16  1  17  13  5  17  16  12  3  22  17  19  3  16  22  20  14  3  1  19  10  10  17  21  15  1  12  16  3  4  15  16  18  19  17  13  17  14  22  20  12  7  24  13  25  4  4  17  8  21  20  10  1  2  9  6  7  6  12  25  1  23  20  5  6  15  14  20  13  13  3  11  24  9  11  13  12  9  21  3  7  12  1  9  25  21  23  16  16  9  25  8  15  12  18  13  9  10  7  16  11  11  16  12  13  5  19  20  24  22  21  23  22  18  12  14  5  19  3  12  4  21  19  15  22  9  21  17  13  11  3  6  22  11  5  9  1  14  22  21  24  21  10  23  25  21  10  15  1  15  2  12  2  3  10  24  13  5  8  23  23  8  11  12  12  1  6  22  13  17  4  18  7  6  24  17  25  15  25  24  19  12  19  10  4  10  13  15  13  11  11  22  14  13  24  5  3  23  11  10  18  24  13  11  2  15  7  20  16  1  7  5  8  1  19  23  19  21  25  17  20  5  5  7  21  16  5  22  6  4  6  22  17  16  13  5  4  24  23  7  4  3  5  9  3  15  24  19  12  6  20  19  21  8  6  14  13  9  5  8  17  10  21  2  25  16  25  17  20  23  1  24  4  8  8  7  8  5  17  4  5  17  17  18  17  20  17  2  14  16  4  3  10  2  4  25  23  6  24  20  14  17  12  14  12  22  20  23  4  3  25  17  15  24  5  5  24  12  5  13  10  18  6  7  11  16  3  21  13  4  2  3  19  18  6  10  4  1  17  20  5  6  10  22  24  4  16  23  7  3  8  5  1  25  17  16  9  1  16  14  21  3  15  4  19  17  8  18  5  3  22  14  9  19  24  7  9  12  25  25  9  24  9  14  15  8  24  20  17  15  14  25  9  15  23  13  23  21  8  20  11  2  8  6  21  14  7  18  23  1  17  12  13  23  8  13  15  24  21  13  1  21  23  24  20  18  10  1  10  18  24  9  3  4  25  23  10  24  2  10  14  12  23  5  21  1  9  3  15  21  11  11  6  15  23  19  17  3  7  9  4  20  25  4  13  24  7  21  10  9  20  2  13  19  4  18  12  9  21  11  21  9  23  1  14  15  3  19  25  15  12  15  21  20  4  20  21  5  18  23  9  13  3  13  12  6  3  4  11  22  18  12  25  4  15  9  20  5  18  7  2  23  24  18  7  17  3  15  6  13  12  9  17  1  18  14  25  4  4  14  19  14  24  19  9  4  7  8  12  5  18  10  23  9  13  21  14  24  23  20  11  16  13  23  9  19  2  7  13  17  1  24  7  16  9  13  14  19  21  5  18  14  6  16  20  17  22  22  13  6  20  16  21  25  11  24  24  23  13  13  6  17  22  18  16  15  2  11  6  19  13  13  25  2  21  1  8  21  14  2  10  23  6  22  22  1  5  5  19  24  12  4  15  24  9  6  7  4  5  5  23  25  17  25  18  1  7  5  19  1  14  11  19  19  10  5  11  4  4  17  4  21  4  20  1  15  15  11  5  25  17  14  12  11  13  9  6  16  3  8  20  6  9  19  22  19  3  2  16  15  17  18  20  17  11  13  25  14  15  18  1  21  5  4  22  7  18  20  10  19  21  20  21  14  13  3  8  17  16  8  15  13  23  4  2  10  9  11  14  15  6  21  9  24  9  2  12  15  4  4  10  13  15  2  25  17  3  5  20  17  23  9  2  14  3  8  16  21  8  7  1  13  8  21  9  24  6  11  6  1  22  21  8  18  10  4  5  8  11  25  12  21  2  25  18  11  25  22  12  10  20  20  25  1  11  1  11  3  18  2  12  17  12  6  9  20  23  19  21  10  9  8  2  2  9  11  20  17  20  24  7  12  9  10  20  22  14  8  17  5  18  6  14  20  5  20  4  17  12  19  1  12  17  14  2  19  4  8  18  22  14  21  7  15  4  3  12  14  10  23  10  2  10  4  14  17  12  12  6  22  7  11  6  22  21  20  25  24  15  10  10  20  21  2  25  4  6  7  5  16  3  13  9  7  15  24  13  22  3  22  22  1  6  19  15  7  1  6  15  19  5  1  7  3  3  6  24  12  5  10  17  16  4  9  12  13  12  14  7  6  22  15  24  20  24  2  1  13  23  18  22  6  2  7  21  2  24  20  17  5  5  3  15  4  8  23  2  18  12  17  5  16  12  10  14  22  6  23  20  21  15  23  7  20  13  2  4  8  24  12  1  24  20  20  19  18  7  3  18  19  25  15  9  14  22  22  7  24  6  8  11  6  16  2  23  9  24  25  11  19  16  11  14  17  17  14  1  22  14  22  11  9  4  15  17  6  3  5  8  2  3  12  5  8  15  23  16  15  12  11  10  8  25  23  14  3  8  2  6  3  12  22  23  12  11  14  10  25  5  20  16  4  20  13  20  1  2  23  4  20  5  15  23  12  20  5  18  10  3  21  12  16  19  24  20  18  4  17  12  19  7  15  21  18  14  3  1  10  9  12  1  22  3  6  15  1  8  16  22  16  8  7  2  12  14  5  12  7  11  25  17  20  21  25  23  11  12  12  6  24  5  24  5  15  15  7  8  6  19  2  15  16  5  24  15  7  23  25  14  19  11  15  3  20  24  13  14  1  4  5  13  1  3  9  18  1  20  3  25  15  12  7  13  10  9  9  3  25  5  24  8  1  7  23  24  25  12  3  24  22  16  4  13  15  18  18  2  9  9  14  6  7  25  15  16  22  6  14  11  22  16  24  23  12  20  19  13  16  5  17  4  22  8  11  15  9  15  25  18  20  25  16  22  20  9  11  15  10  16  21  8  1  2  3  17  13  7  19  7  18  24  10  22  1  2  14  12  18  5  22  6  14  1  22  20  10  2  9  9  14  19  12  19  18  19  6  16  2  5  7  8  11  20  7  1  17  20  23  2  25  9  11  20  6  14  11  20  16  2  16  11  2  9  19  21  11  16  25  4  25  12  16  4  19  7  2  16  17  12  10  3  25  18  7  20  7  1  9  10  4  12  2  4  5  23  25  23  7  9  11  18  22  14  4  22  18  16  21  24  25  21  22  12  13  3  3  23  8  7  2  13  2  8  4  4  6  12  24  4  23  25  16  15  21  15  23  4  20  21  14  22  19  12  2  1  9  9  10  18  2  12  19  18  24  5  10  13  21  13  20  9  20  10  18  7  10  24  25  13  7  18  13  8  4  21  23  7  24  15  5  2  24  20  16  14  13  1  15  8  14  19  15  2  2  10  7  16  12  6  21  14  8  13  10  19  10  17  13  13  10  8  9  19  23  12  14  9  22  21  2  24  12  9  19  14  24  3  21  7  10  16  25  14  5  25  21  8  2  9  1  1  10  21  1  2  25  6  18  7  11  8  24  10  20  13  15  4  19  23  9  19  7  2  24  2  22  11  13  10  25  23  19  10  14  20  8  15  17  13  23  6  6  24  18  22  5  5  24  1  6  17  21  16  4  24  24  20  8  16  3  9  7  8  16  19  6  16  24  8  1  24  9  5  5  25  5  23  24  18  21  15  11  16  25  3  2  19  16  14  6  12  14  1  13  12  24  18  19  25  11  6  8  24  4  14  3  11  14  5  3  22  14  18  5  24  2  1  22  7  6  21  21  19  20  1  15  18  20  17  14  18  4  9  17  23  12  12  20  16  10  23  7  24  9  15  7  16  6  17  10  1  11  9  18  2  20  15  10  18  9  1  21  6  4  9  9  1  10  23  2  5  12  12  4  17  3  25  7  12  15  13  18  16  3  8  6  8  12  11  17  25  16  12  14  16  19  1  12  11  7  21  12  20  24  10  17  6  8  10  """

import re
sequence = [int(x) for x in re.findall(r'\d+', sequence_str)]

tally_data = {    1: 40147,
    2: 39899,
    3: 39847,
    4: 40198,
    5: 39887,
    6: 40048,
    7: 40273,
    8: 40428,
    9: 40310,
    10: 39915,
    11: 39601,
    12: 40093,
    13: 39823,
    14: 40102,
    15: 39710,
    16: 40051,
    17: 40020,
    18: 39796,
    19: 39803,
    20: 40142,
    21: 40107,
    22: 40064,
    23: 39864,
    24: 39776,
    25: 40096,
}

counts = list(tally_data.values())
chi_sq_stat, p_value_chi = stats.chisquare(counts)

median = np.median(sequence)
runs = []
for x in sequence:
    if x > median:
        runs.append(1)
    elif x < median:
        runs.append(0)

n0 = runs.count(0)
n1 = runs.count(1)
total_runs = 1
for i in range(1, len(runs)):
    if runs[i] != runs[i-1]:
        total_runs += 1

expected_runs = ((2 * n0 * n1) / (n0 + n1)) + 1
sd_runs = np.sqrt((2 * n0 * n1 * (2 * n0 * n1 - n0 - n1)) / ((n0 + n1)**2 * (n0 + n1 - 1)))
z_runs = (total_runs - expected_runs) / sd_runs
p_value_runs = 2 * (1 - stats.norm.cdf(abs(z_runs)))

x_vals = sequence[:-1]
y_vals = sequence[1:]

total_samples = sum(tally_data.values())
expected_freq = total_samples / len(tally_data)

plt.figure(figsize=(15, 6))

plt.subplot(1, 2, 1)
plt.bar(tally_data.keys(), tally_data.values(), color='mediumseagreen', edgecolor='black', alpha=0.7)

plt.axhline(expected_freq, color='red', linestyle='--', label=f'Expected ({int(expected_freq)})')
plt.ylim(expected_freq - 1000, expected_freq + 1000) 
plt.title(f'Distribution of {total_samples:,} Samples')

plt.xlabel('Value')
plt.ylabel('Frequency')
plt.legend()

plt.subplot(1, 2, 2)
plt.scatter(x_vals, y_vals, s=5, color='darkblue', alpha=0.4)
plt.title('Lag Plot ($x_n$ vs $x_{n+1}$)')
plt.xlabel('$Value_n$')
plt.ylabel('$Value_{n+1}$')

plt.tight_layout()
plt.savefig('prng_analysis.png')

print(f"NUMBER OF ITEMS IN SEQUENCE: {len(sequence)}")
print(f"CHI-SQUARED (10K TALLY): {chi_sq_stat:.4f}, P-VALUE: {p_value_chi:.4f}")
print(f"RUNS TEST (2K SEQUENCE): TOTAL RUNS: {total_runs}, EXPECTED: {expected_runs:.2f}, Z: {z_runs:.4f}, P-VALUE: {p_value_runs:.4f}")

correlation = np.corrcoef(x_vals, y_vals)[0, 1]
print(f"LAG-1 CORRELATION: {correlation:.4f}")
